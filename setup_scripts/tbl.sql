DROP TABLE crime_table;
CREATE EXTERNAL TABLE crime_table (
  IncidntNum int,
  Category string,
  Descript string,
  DayOfWeek string,
  Date date,
  Time int,
  PdDistrict string,
  Resolution string,
  Address string,
  Y int,
  X int,
  Location string,
  PdId int
) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES ( "separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/crimenew';


DROP TABLE IMP_CAT;
CREATE TABLE IMP_CAT AS
SELECT CATEGORY, DESCRIPT, X, Y FROM CRIME_TABLE
WHERE CATEGORY = 'VEHICLE THEFT' OR CATEGORY = 'LARCENY/THEFT'
OR CATEGORY = 'ROBBERY';

DROP TABLE LOC_MULT;
CREATE TABLE LOC_MULT AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77673600 -
X) * pi()/180 / 2),2) + COS(37.77673600 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41639500 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE USCF_GAR;
CREATE TABLE USCF_GAR AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76852000 -
X) * pi()/180 / 2),2) + COS(37.76852000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.38961000 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

CREATE TABLE USCF_GAR_BIKE AS
SELECT DESCRIPT, COUNT(DESCRIPT) FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76852000 -
X) * pi()/180 / 2),2) + COS(37.76852000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.38961000 - Y) *
pi()/180 / 2), 2) ) ) < 1 AND DESCRIPT = 'BIKE THEFT'
GROUP BY DESCRIPT;

DROP TABLE CAL_SCI;
CREATE TABLE CAL_SCI AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76988297 -
X) * pi()/180 / 2),2) + COS(37.76988297 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.46686332 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE SUT_STO;
CREATE TABLE SUT_STO AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79012600 -
X) * pi()/180 / 2),2) + COS(37.79012600 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.40674000 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE MISS_CLI;
CREATE TABLE MISS_CLI AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76091600 -
X) * pi()/180 / 2),2) + COS(37.76091600 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41233400 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE USCF_OW;
CREATE TABLE USCF_OW AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76828000 -
X) * pi()/180 / 2),2) + COS(37.76828000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.39395000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE GOLD_GAR;
CREATE TABLE GOLD_GAR AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79570100 -
X) * pi()/180 / 2),2) + COS(37.79570100 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39849000 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE USCF_GEN;
CREATE TABLE USCF_GEN AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76763000 -
X) * pi()/180 / 2),2) + COS(37.76763000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39241000 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE JAP_CEN;
CREATE TABLE JAP_CEN AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78496900 -
X) * pi()/180 / 2),2) + COS(37.78496900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.43038000 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE GEN_HOSP;
CREATE TABLE GEN_HOSP AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.75671731 -
X) * pi()/180 / 2),2) + COS(37.75671731 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.38764896 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE WH_F;
CREATE TABLE WH_F AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76411300 -
X) * pi()/180 / 2),2) + COS(37.76411300 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.40298700 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE FIF_GAR;
CREATE TABLE FIF_GAR AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78337100 -
X) * pi()/180 / 2),2) + COS(37.78337100 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.40506900 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE MOSC;
CREATE TABLE MOSC AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78471200 -
X) * pi()/180 / 2),2) + COS(37.78471200 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.39936700 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE ELL;
CREATE TABLE ELL AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78604121 -
X) * pi()/180 / 2),2) + COS(37.78604121 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.40709853 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE MISSI;
CREATE TABLE MISSI AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76091600 -
X) * pi()/180 / 2),2) + COS(37.76091600 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41233400 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE UCS_WILL;
CREATE TABLE UCS_WILL AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76842000 -
X) * pi()/180 / 2),2) + COS(37.76842000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39262000 - Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE CC_MISS;
CREATE TABLE CC_MISS AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.75484683 -
X) * pi()/180 / 2),2) + COS(37.75484683 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.42030418- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE CIV_PL;
CREATE TABLE CIV_PL AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77948045 -
X) * pi()/180 / 2),2) + COS(37.77948045 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41759951- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE UN_PL;
CREATE TABLE UN_PL AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78053500 -
X) * pi()/180 / 2),2) + COS(37.78053500 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41321200- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE EVER;
CREATE TABLE EVER AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76354200 -
X) * pi()/180 / 2),2) + COS(37.76354200 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.42964600- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE N_BEA;
CREATE TABLE N_BEA AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79830500 -
X) * pi()/180 / 2),2) + COS(37.79830500 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.40952700- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE D_MOM;
CREATE TABLE D_MOM AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76569900 -
X) * pi()/180 / 2),2) + COS(37.76569900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41352100- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE BART;
CREATE TABLE BART AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.75616400 -
X) * pi()/180 / 2),2) + COS(37.75616400 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.42025900- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE FLO_YO;
CREATE TABLE FLO_YO AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77348100 -
X) * pi()/180 / 2),2) + COS(37.77348100 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41771600- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE CAL_T;
CREATE TABLE CAL_T AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.75741000 -
X) * pi()/180 / 2),2) + COS(37.75741000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.39237000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE MU;
CREATE TABLE MU AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76056500 -
X) * pi()/180 / 2),2) + COS(37.76056500 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.42118800- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE RAI_G;
CREATE TABLE RAI_G AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76910900 -
X) * pi()/180 / 2),2) + COS(37.76910900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.41505800- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE RAPH;
CREATE TABLE RAPH AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78300893 -
X) * pi()/180 / 2),2) + COS(37.78300893 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.42950434- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE ZEIT;
CREATE TABLE ZEIT AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77002800 -
X) * pi()/180 / 2),2) + COS(37.77002800 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN((-122.42209800- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE ELLI;
CREATE TABLE ELLI AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78604121 -
X) * pi()/180 / 2),2) + COS(37.78604121 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.40709853- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE SUT;
CREATE TABLE SUT AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79012600 -
X) * pi()/180 / 2),2) + COS(37.79012600 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.40674000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE GATE;
CREATE TABLE GATE AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79570100 -
X) * pi()/180 / 2),2) + COS(37.79570100 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39849000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE B_PAR;
CREATE TABLE B_PAR AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77149900 -
X) * pi()/180 / 2),2) + COS(37.77149900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39800000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE COURT;
CREATE TABLE COURT AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78051900 -
X) * pi()/180 / 2),2) + COS(37.78051900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41901400- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE VAL;
CREATE TABLE VAL AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79678900 -
X) * pi()/180 / 2),2) + COS(37.79678900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.42902300- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE RITE;
CREATE TABLE RITE AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76158600 -
X) * pi()/180 / 2),2) + COS(37.76158600 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.42571500- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE DRIF;
CREATE TABLE DRIF AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77447300 -
X) * pi()/180 / 2),2) + COS(37.77447300 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41029700- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE TRUC;
CREATE TABLE TRUC AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76679500 -
X) * pi()/180 / 2),2) + COS(37.76679500 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41578300- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE EMB;
CREATE TABLE EMB AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79464385 -
X) * pi()/180 / 2),2) + COS(37.79464385 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39964430- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE BOA;
CREATE TABLE BOA AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77486200 -
X) * pi()/180 / 2),2) + COS(37.77486200 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41858100- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE EMB2;
CREATE TABLE EMB2 AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79502200 -
X) * pi()/180 / 2),2) + COS(37.79502200 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39874900- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE EMB3;
CREATE TABLE EMB3 AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79513200 -
X) * pi()/180 / 2),2) + COS(37.79513200 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39601400- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE EMB4;
CREATE TABLE EMB4 AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79496000 -
X) * pi()/180 / 2),2) + COS(37.79496000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39631800- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE PUE;
CREATE TABLE PUE AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76413800 -
X) * pi()/180 / 2),2) + COS(37.76413800 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.42210900- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE UK;
CREATE TABLE UK AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77052985 -
X) * pi()/180 / 2),2) + COS(37.77052985 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39740712- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE ARM;
CREATE TABLE ARM AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.72763800 -
X) * pi()/180 / 2),2) + COS(37.72763800 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39525500- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE DOSA;
CREATE TABLE DOSA AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.75722400 -
X) * pi()/180 / 2),2) + COS(37.75722400 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.42085000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE BOOG;
CREATE TABLE BOOG AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.75548474 -
X) * pi()/180 / 2),2) + COS(37.75548474 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.42068142- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE MIKE;
CREATE TABLE MIKE AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77562400 -
X) * pi()/180 / 2),2) + COS(37.77562400 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41178100- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE BUTL;
CREATE TABLE BUTL AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78089800 -
X) * pi()/180 / 2),2) + COS(37.78089800 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39421400- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE LIB;
CREATE TABLE LIB AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77915913 -
X) * pi()/180 / 2),2) + COS(37.77915913 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41580788- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE CIV;
CREATE TABLE CIV AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.77948045 -
X) * pi()/180 / 2),2) + COS(37.77948045 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.41759951- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE FIF;
CREATE TABLE FIF AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78337100 -
X) * pi()/180 / 2),2) + COS(37.78337100 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.40506900- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE ZION;
CREATE TABLE ZION AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78544300 -
X) * pi()/180 / 2),2) + COS(37.78544300 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.44059000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE UNION;
CREATE TABLE UNION AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.78793100 -
X) * pi()/180 / 2),2) + COS(37.78793100 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.40750000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE MARY;
CREATE TABLE MARY AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79184800 -
X) * pi()/180 / 2),2) + COS(37.79184800 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.40447100- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;


DROP TABLE PORT;
CREATE TABLE PORT AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.79483500 -
X) * pi()/180 / 2),2) + COS(37.79483500 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.40535100- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE GENEN;
CREATE TABLE GENEN AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.76760000 -
X) * pi()/180 / 2),2) + COS(37.76760000 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39279000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE ZOO;
CREATE TABLE ZOO AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.73290900 -
X) * pi()/180 / 2),2) + COS(37.73290900 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.50324000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;

DROP TABLE THIR;
CREATE TABLE THIR AS
SELECT CATEGORY, COUNT(CATEGORY) AS CT_CAT FROM IMP_CAT
WHERE 3956 * 2 * ASIN(SQRT( POWER(SIN((37.72517300 -
X) * pi()/180 / 2),2) + COS(37.72517300 * pi()/180 ) *
COS(X *  pi()/180) * POWER(SIN(( -122.39552000- Y) *
pi()/180 / 2), 2) ) ) < 1
GROUP BY CATEGORY;
